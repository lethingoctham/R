# Thi???t l???p thu m???c hi???n hành
setwd("C:\\Users\\acer\\Downloads\\")
Benthic <- read.table("Vegetation2.txt ", header = TRUE)
names(Benthic)
str(Benthic)
# Bi???n Species(loài) t??? c???t th??? 2 d???n 24 trong bi???n Benthic
Species <- Benthic[,5:9]
names(Species)
str(Species)
# Ki???m tra dimensions - chi???u c???a bi???n Species
n <- dim(Species)
n
# 58 dòng - tuong ???ng v???i 5 sites - v??? trí thu th???p m???u v???t
# Tuong ???ng v???i m???i v??? trí thì s??? ghi nh???n du???c nh???ng loài 
#sinh v???t bi???n nào?
# Có bao nhiêu loài sinh v???t bi???n ??? v??? trí s??? 1
sum(Species[1,], na.rm = TRUE)
# K???t qu??? 91 loài sinh v???t bi???n xu???t hi???n ??? site #1
sum(Species[,2], na.rm = TRUE)
#.. Làm 5 l???n d??? ki???m tra s??? lu???ng sinh v???t bi???n 
# xu???t hi???n t???i các sites
TA <- vector(length = n[1])
for (i in 1:n[1]){
  TA[i] <- sum(Species[i,], na.rm = TRUE)
}
TA
# Hàm  rowsums: tính toán t???ng c???a các c???t ??? trong hàng 
# tham s??? na.rm=TRUE => Lo???i b??? các giá tr??? r???ng 
TA02 <- rowSums(Species, na.rm = TRUE)  
TA02
# Di vào chi ti???t t???i t???ng v??? trí quan sát 
sum(Species[1,]>0, na.rm = TRUE)
#K???t qu??? chúng ta có 11 loài khác nhau xu???t hi???n t???i v??? trí 1
Richness <- vector(length = n[1])
for (i in 1:n[1]){
  Richness[i] <- sum(Species[i,]>0, na.rm= TRUE)
}
Richness

Richness02 <- rowSums(Species>0, na.rm = TRUE)
Richness02
# Ch??? s??? da d???ng loài
#Tìm hi???u cách tính ch??? s??? da d???ng loài
#H - sum bi???n ch???y t??? i -> m c???a bi???n p: xác su???t * log10 p
RS <- rowSums(Species, na.rm = TRUE)
prop <-Species / RS
H <- rowSums(prop * log10(prop), na.rm = TRUE)
H

Index.function <-function(Spec, Choice){
  if (Choice=="Richness") {
    Index <- rowSums(Species>0, na.rm = TRUE)
  }
  if (Choice=="Total Abundance") {
    Index <- rowSums(Species, na.rm = TRUE)
  }
  if (Choice=="Shannon") {
    RS <- rowSums(Species, na.rm=TRUE)
    prop <- Species / RS
    Index <- -rowSums(prop * log10(prop), na.rm= TRUE)
  }
  list(Index=Index, MyChoice= Choice)
}


Index.function(Species,"Shannon")
